---
title: "Using_rwave_for_seahorse_data_analysis"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Using_rwave_for_seahorse_data_analysis}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(rwave)
library(dplyr)
library(purrr)
library(tidyr)
library(ggplot2)
```

## Load the data

```{r}
mito_stress_test
```

**rwave** provdes two functions to visualize profiles of OCR and ECAR.

```{r fig.width=10, fig.height=6}
sketch_ocr(mito_stress_test)
```

```{r fig.width=10, fig.height=6}
sketch_ecar(mito_stress_test)
```

Seahorse data are usually interpreted based on a collection of representive OCR values. We can use the function `summarize_ocr` to find those values.

```{r}
representive_ocr <- summarize_ocr(mito_stress_test)
glimpse(representive_ocr)
```

Once we have the representive OCRs, we can calculate glycoAPR and mitoAPR by using the function `summarize_apr`.

```{r}
APR_dat <- summarize_apr(mito_stress_test, which_assay = "XFe96")
glimpse(APR_dat)
```

FInally we can visualize the bioenergetic sapce by using the function `sketch_bioenergenic_space`.

```{r fig.width=10, fig.height=5}
sketch_bioenergetic_space(APR_dat, average = TRUE, background = FALSE)
```

We can also visualize all the data rather than the average. 

```{r}
sketch_bioenergetic_space(APR_dat, average = FALSE)
```

